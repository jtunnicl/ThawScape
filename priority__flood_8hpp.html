<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ThawScape: priority_flood.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ThawScape
   </div>
   <div id="projectbrief">ThawScape is an experimental code to simulate the influence of thermokarst dynamics upon ice-cored terrain</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">priority_flood.hpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="Array2D_8hpp_source.html">Array2D.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="data__structures_8h_source.html">data_structures.h</a>&quot;</code><br />
<code>#include &lt;queue&gt;</code><br />
<code>#include &lt;limits&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;cstdlib&gt;</code><br />
<code>#include &quot;<a class="el" href="utility_8h_source.html">utility.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for priority_flood.hpp:</div>
<div class="dyncontent">
<div class="center"><img src="priority__flood_8hpp__incl.png" border="0" usemap="#priority__flood_8hpp" alt=""/></div>
<map name="priority__flood_8hpp" id="priority__flood_8hpp">
<area shape="rect" id="node2" href="Array2D_8hpp.html" title="Array2D.hpp" alt="" coords="283,155,386,181"/>
<area shape="rect" id="node9" href="data__structures_8h.html" title="data_structures.h" alt="" coords="651,155,786,181"/>
<area shape="rect" id="node17" href="utility_8h.html" title="utility.h" alt="" coords="693,80,760,107"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="priority__flood_8hpp__dep__incl.png" border="0" usemap="#priority__flood_8hppdep" alt=""/></div>
<map name="priority__flood_8hppdep" id="priority__flood_8hppdep">
<area shape="rect" id="node2" href="flood_8cpp.html" title="flood.cpp" alt="" coords="31,80,111,107"/>
</map>
</div>
</div>
<p><a href="priority__flood_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8ceda9b8732cdde29e2de59d2a82f860"><td class="memTemplParams" colspan="2">template&lt;class elev_t &gt; </td></tr>
<tr class="memitem:a8ceda9b8732cdde29e2de59d2a82f860"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="priority__flood_8hpp.html#a8ceda9b8732cdde29e2de59d2a82f860">original_priority_flood</a> (<a class="el" href="classArray2D.html">Array2D</a>&lt; elev_t &gt; &amp;elevations)</td></tr>
<tr class="memdesc:a8ceda9b8732cdde29e2de59d2a82f860"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fills all pits and removes all digital dams from a DEM.  <a href="#a8ceda9b8732cdde29e2de59d2a82f860">More...</a><br /></td></tr>
<tr class="separator:a8ceda9b8732cdde29e2de59d2a82f860"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a838ba557d4977d2a062e866649cb4adb"><td class="memTemplParams" colspan="2">template&lt;class elev_t &gt; </td></tr>
<tr class="memitem:a838ba557d4977d2a062e866649cb4adb"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="priority__flood_8hpp.html#a838ba557d4977d2a062e866649cb4adb">improved_priority_flood</a> (<a class="el" href="classArray2D.html">Array2D</a>&lt; elev_t &gt; &amp;elevations)</td></tr>
<tr class="memdesc:a838ba557d4977d2a062e866649cb4adb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fills all pits and removes all digital dams from a DEM.  <a href="#a838ba557d4977d2a062e866649cb4adb">More...</a><br /></td></tr>
<tr class="separator:a838ba557d4977d2a062e866649cb4adb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdff31630acfa8e31bd5caadb3e8c0b0"><td class="memTemplParams" colspan="2">template&lt;class elev_t &gt; </td></tr>
<tr class="memitem:abdff31630acfa8e31bd5caadb3e8c0b0"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="priority__flood_8hpp.html#abdff31630acfa8e31bd5caadb3e8c0b0">priority_flood_epsilon</a> (<a class="el" href="classArray2D.html">Array2D</a>&lt; elev_t &gt; &amp;elevations)</td></tr>
<tr class="memdesc:abdff31630acfa8e31bd5caadb3e8c0b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assigns every cell an elevation which guarantees drainage.  <a href="#abdff31630acfa8e31bd5caadb3e8c0b0">More...</a><br /></td></tr>
<tr class="separator:abdff31630acfa8e31bd5caadb3e8c0b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5225a93aa7b5cec8906d2ab90a50fe8"><td class="memTemplParams" colspan="2">template&lt;&gt; </td></tr>
<tr class="memitem:ac5225a93aa7b5cec8906d2ab90a50fe8"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="priority__flood_8hpp.html#ac5225a93aa7b5cec8906d2ab90a50fe8">priority_flood_epsilon</a> (<a class="el" href="classArray2D.html">Array2D</a>&lt; uint8_t &gt; &amp;elevations)</td></tr>
<tr class="separator:ac5225a93aa7b5cec8906d2ab90a50fe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd33e6f115a5d838643f69a1d362ef29"><td class="memTemplParams" colspan="2">template&lt;&gt; </td></tr>
<tr class="memitem:abd33e6f115a5d838643f69a1d362ef29"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="priority__flood_8hpp.html#abd33e6f115a5d838643f69a1d362ef29">priority_flood_epsilon</a> (<a class="el" href="classArray2D.html">Array2D</a>&lt; uint16_t &gt; &amp;elevations)</td></tr>
<tr class="separator:abd33e6f115a5d838643f69a1d362ef29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79ae65e38ff08a21616080ae46d97392"><td class="memTemplParams" colspan="2">template&lt;&gt; </td></tr>
<tr class="memitem:a79ae65e38ff08a21616080ae46d97392"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="priority__flood_8hpp.html#a79ae65e38ff08a21616080ae46d97392">priority_flood_epsilon</a> (<a class="el" href="classArray2D.html">Array2D</a>&lt; int16_t &gt; &amp;elevations)</td></tr>
<tr class="separator:a79ae65e38ff08a21616080ae46d97392"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76d8dc6a2af1f6cd9ee1c0501f41b52d"><td class="memTemplParams" colspan="2">template&lt;&gt; </td></tr>
<tr class="memitem:a76d8dc6a2af1f6cd9ee1c0501f41b52d"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="priority__flood_8hpp.html#a76d8dc6a2af1f6cd9ee1c0501f41b52d">priority_flood_epsilon</a> (<a class="el" href="classArray2D.html">Array2D</a>&lt; uint32_t &gt; &amp;elevations)</td></tr>
<tr class="separator:a76d8dc6a2af1f6cd9ee1c0501f41b52d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18b13cccb6f35eb9d1dbd933909b15d5"><td class="memTemplParams" colspan="2">template&lt;&gt; </td></tr>
<tr class="memitem:a18b13cccb6f35eb9d1dbd933909b15d5"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="priority__flood_8hpp.html#a18b13cccb6f35eb9d1dbd933909b15d5">priority_flood_epsilon</a> (<a class="el" href="classArray2D.html">Array2D</a>&lt; int32_t &gt; &amp;elevations)</td></tr>
<tr class="separator:a18b13cccb6f35eb9d1dbd933909b15d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3104ce738d1e4f60e734026524708100"><td class="memTemplParams" colspan="2">template&lt;class elev_t &gt; </td></tr>
<tr class="memitem:a3104ce738d1e4f60e734026524708100"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="priority__flood_8hpp.html#a3104ce738d1e4f60e734026524708100">priority_flood_flowdirs</a> (const <a class="el" href="classArray2D.html">Array2D</a>&lt; elev_t &gt; &amp;elevations, <a class="el" href="classArray2D.html">Array2D</a>&lt; int8_t &gt; &amp;flowdirs)</td></tr>
<tr class="memdesc:a3104ce738d1e4f60e734026524708100"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines D8 flow directions and implicitly fills pits.  <a href="#a3104ce738d1e4f60e734026524708100">More...</a><br /></td></tr>
<tr class="separator:a3104ce738d1e4f60e734026524708100"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81be82c61b988a9f74bfd98b876cb333"><td class="memTemplParams" colspan="2">template&lt;class elev_t &gt; </td></tr>
<tr class="memitem:a81be82c61b988a9f74bfd98b876cb333"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="priority__flood_8hpp.html#a81be82c61b988a9f74bfd98b876cb333">pit_mask</a> (const <a class="el" href="classArray2D.html">Array2D</a>&lt; elev_t &gt; &amp;elevations, <a class="el" href="classArray2D.html">Array2D</a>&lt; int32_t &gt; &amp;pit_mask)</td></tr>
<tr class="memdesc:a81be82c61b988a9f74bfd98b876cb333"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicates which cells are in pits.  <a href="#a81be82c61b988a9f74bfd98b876cb333">More...</a><br /></td></tr>
<tr class="separator:a81be82c61b988a9f74bfd98b876cb333"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79aca652d5a3fc0a74b0c8d0e8fea435"><td class="memTemplParams" colspan="2">template&lt;class elev_t &gt; </td></tr>
<tr class="memitem:a79aca652d5a3fc0a74b0c8d0e8fea435"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="priority__flood_8hpp.html#a79aca652d5a3fc0a74b0c8d0e8fea435">priority_flood_watersheds</a> (<a class="el" href="classArray2D.html">Array2D</a>&lt; elev_t &gt; &amp;elevations, <a class="el" href="classArray2D.html">Array2D</a>&lt; int32_t &gt; &amp;labels, bool alter_elevations)</td></tr>
<tr class="memdesc:a79aca652d5a3fc0a74b0c8d0e8fea435"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gives a common label to all cells which drain to a common point.  <a href="#a79aca652d5a3fc0a74b0c8d0e8fea435">More...</a><br /></td></tr>
<tr class="separator:a79aca652d5a3fc0a74b0c8d0e8fea435"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a838ba557d4977d2a062e866649cb4adb"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class elev_t &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void improved_priority_flood </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classArray2D.html">Array2D</a>&lt; elev_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>elevations</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fills all pits and removes all digital dams from a DEM. </p>
<dl class="section author"><dt>Author</dt><dd>Richard Barnes (<a href="#" onclick="location.href='mai'+'lto:'+'rba'+'rn'+'es@'+'um'+'n.e'+'du'; return false;">rbarn<span style="display: none;">.nosp@m.</span>es@u<span style="display: none;">.nosp@m.</span>mn.ed<span style="display: none;">.nosp@m.</span>u</a>)</dd></dl>
<p>Priority-Flood starts on the edges of the DEM and then works its way inwards using a priority queue to determine the lowest cell which has a path to the edge. The neighbours of this cell are added to the priority queue if they are higher. If they are lower, they are raised to the elevation of the cell adding them, thereby filling in pits. The neighbors are then added to a "pit" queue which is used to flood pits. Cells which are higher than a pit being filled are added to the priority queue. In this way, pits are filled without incurring the expense of the priority queue.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">&amp;elevations</td><td>A grid of cell elevations</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><ol type="1">
<li><b>elevations</b> contains the elevations of every cell or a value <em>NoData</em> for cells not part of the DEM. Note that the <em>NoData</em> value is assumed to be a negative number less than any actual data value.</li>
</ol>
</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd><ol type="1">
<li><b>elevations</b> contains the elevations of every cell or a value <em>NoData</em> for cells not part of the DEM.</li>
<li><b>elevations</b> contains no landscape depressions or digital dams. </li>
</ol>
</dd></dl>

</div>
</div>
<a class="anchor" id="a8ceda9b8732cdde29e2de59d2a82f860"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class elev_t &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void original_priority_flood </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classArray2D.html">Array2D</a>&lt; elev_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>elevations</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fills all pits and removes all digital dams from a DEM. </p>
<dl class="section author"><dt>Author</dt><dd>Richard Barnes (<a href="#" onclick="location.href='mai'+'lto:'+'rba'+'rn'+'es@'+'um'+'n.e'+'du'; return false;">rbarn<span style="display: none;">.nosp@m.</span>es@u<span style="display: none;">.nosp@m.</span>mn.ed<span style="display: none;">.nosp@m.</span>u</a>)</dd></dl>
<p>Priority-Flood starts on the edges of the DEM and then works its way inwards using a priority queue to determine the lowest cell which has a path to the edge. The neighbours of this cell are added to the priority queue. If the neighbours are lower than the cell which is adding them, then they are raised to match its elevation; this fills depressions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">&amp;elevations</td><td>A grid of cell elevations</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><ol type="1">
<li><b>elevations</b> contains the elevations of every cell or a value <em>NoData</em> for cells not part of the DEM. Note that the <em>NoData</em> value is assumed to be a negative number less than any actual data value.</li>
</ol>
</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd><ol type="1">
<li><b>elevations</b> contains the elevations of every cell or a value <em>NoData</em> for cells not part of the DEM.</li>
<li><b>elevations</b> contains no landscape depressions or digital dams. </li>
</ol>
</dd></dl>

</div>
</div>
<a class="anchor" id="a81be82c61b988a9f74bfd98b876cb333"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class elev_t &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void pit_mask </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classArray2D.html">Array2D</a>&lt; elev_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>elevations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classArray2D.html">Array2D</a>&lt; int32_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>pit_mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indicates which cells are in pits. </p>
<dl class="section author"><dt>Author</dt><dd>Richard Barnes (<a href="#" onclick="location.href='mai'+'lto:'+'rba'+'rn'+'es@'+'um'+'n.e'+'du'; return false;">rbarn<span style="display: none;">.nosp@m.</span>es@u<span style="display: none;">.nosp@m.</span>mn.ed<span style="display: none;">.nosp@m.</span>u</a>)</dd></dl>
<p>This version of Priority-Flood starts on the edges of the DEM and then works its way inwards using a priority queue to determine the lowest cell which has a path to the edge. If a cell is lower than this cell then it is part of a pit and is given a value 1 to indicate this. The result is a grid where every cell which is in a pit is labeled.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&amp;elevations</td><td>A grid of cell elevations </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&amp;pit_mask</td><td>A grid of indicating which cells are in pits</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><ol type="1">
<li><b>elevations</b> contains the elevations of every cell or a value <em>NoData</em> for cells not part of the DEM. Note that the <em>NoData</em> value is assumed to be a negative number less than any actual data value.</li>
</ol>
</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd><ol type="1">
<li><b>pit_mask</b> contains a 1 for each cell which is in a pit and a 0 for each cell which is not. </li>
</ol>
</dd></dl>

</div>
</div>
<a class="anchor" id="abdff31630acfa8e31bd5caadb3e8c0b0"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class elev_t &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void priority_flood_epsilon </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classArray2D.html">Array2D</a>&lt; elev_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>elevations</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assigns every cell an elevation which guarantees drainage. </p>
<dl class="section author"><dt>Author</dt><dd>Richard Barnes (<a href="#" onclick="location.href='mai'+'lto:'+'rba'+'rn'+'es@'+'um'+'n.e'+'du'; return false;">rbarn<span style="display: none;">.nosp@m.</span>es@u<span style="display: none;">.nosp@m.</span>mn.ed<span style="display: none;">.nosp@m.</span>u</a>)</dd></dl>
<p>This version of Priority-Flood starts on the edges of the DEM and then works its way inwards using a priority queue to determine the lowest cell which has a path to the edge. The neighbours of this cell are added to the priority queue if they are higher. If they are lower, then their elevation is increased by a small amount to ensure that they have a drainage path and they are added to a "pit" queue which is used to flood pits. Cells which are higher than a pit being filled are added to the priority queue. In this way, pits are filled without incurring the expense of the priority queue.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">&amp;elevations</td><td>A grid of cell elevations</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><ol type="1">
<li><b>elevations</b> contains the elevations of every cell or a value <em>NoData</em> for cells not part of the DEM. Note that the <em>NoData</em> value is assumed to be a negative number less than any actual data value.</li>
</ol>
</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd><ol type="1">
<li><b>elevations</b> contains the elevations of every cell or a value <em>NoData</em> for cells not part of the DEM.</li>
<li><b>elevations</b> has no landscape depressions, digital dams, or flats. </li>
</ol>
</dd></dl>

</div>
</div>
<a class="anchor" id="ac5225a93aa7b5cec8906d2ab90a50fe8"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void priority_flood_epsilon </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classArray2D.html">Array2D</a>&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>elevations</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="abd33e6f115a5d838643f69a1d362ef29"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void priority_flood_epsilon </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classArray2D.html">Array2D</a>&lt; uint16_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>elevations</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a79ae65e38ff08a21616080ae46d97392"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void priority_flood_epsilon </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classArray2D.html">Array2D</a>&lt; int16_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>elevations</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a76d8dc6a2af1f6cd9ee1c0501f41b52d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void priority_flood_epsilon </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classArray2D.html">Array2D</a>&lt; uint32_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>elevations</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a18b13cccb6f35eb9d1dbd933909b15d5"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void priority_flood_epsilon </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classArray2D.html">Array2D</a>&lt; int32_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>elevations</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3104ce738d1e4f60e734026524708100"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class elev_t &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void priority_flood_flowdirs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classArray2D.html">Array2D</a>&lt; elev_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>elevations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classArray2D.html">Array2D</a>&lt; int8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>flowdirs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines D8 flow directions and implicitly fills pits. </p>
<dl class="section author"><dt>Author</dt><dd>Richard Barnes (<a href="#" onclick="location.href='mai'+'lto:'+'rba'+'rn'+'es@'+'um'+'n.e'+'du'; return false;">rbarn<span style="display: none;">.nosp@m.</span>es@u<span style="display: none;">.nosp@m.</span>mn.ed<span style="display: none;">.nosp@m.</span>u</a>)</dd></dl>
<p>This version of Priority-Flood starts on the edges of the DEM and then works its way inwards using a priority queue to determine the lowest cell which has a path to the edge. The neighbours of this cell are given D8 flow directions which point to it. All depressions are implicitly filled and digital dams removed.</p>
<p>Based on Metz 2011.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&amp;elevations</td><td>A grid of cell elevations </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&amp;flowdirs</td><td>A grid of D8 flow directions</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><ol type="1">
<li><b>elevations</b> contains the elevations of every cell or a value <em>NoData</em> for cells not part of the DEM. Note that the <em>NoData</em> value is assumed to be a negative number less than any actual data value.</li>
</ol>
</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd><ol type="1">
<li><b>flowdirs</b> contains a D8 flow direction of each cell or a value <em>NO_FLOW</em> for those cells which are not part of the DEM.</li>
<li><b>flowdirs</b> has no cells which are not part of a continuous flow path leading to the edge of the DEM. </li>
</ol>
</dd></dl>

</div>
</div>
<a class="anchor" id="a79aca652d5a3fc0a74b0c8d0e8fea435"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class elev_t &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void priority_flood_watersheds </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classArray2D.html">Array2D</a>&lt; elev_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>elevations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classArray2D.html">Array2D</a>&lt; int32_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>alter_elevations</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gives a common label to all cells which drain to a common point. </p>
<dl class="section author"><dt>Author</dt><dd>Richard Barnes (<a href="#" onclick="location.href='mai'+'lto:'+'rba'+'rn'+'es@'+'um'+'n.e'+'du'; return false;">rbarn<span style="display: none;">.nosp@m.</span>es@u<span style="display: none;">.nosp@m.</span>mn.ed<span style="display: none;">.nosp@m.</span>u</a>)</dd></dl>
<p>All the edge cells of the DEM are given unique labels. This version of Priority-Flood starts on the edges of the DEM and then works its way inwards using a priority queue to determine the lowest cell which has a path to the edge. The neighbours of this cell are then given its label. All depressions are implicitly filled and digital dams removed. The result is a grid of cells where all cells with a common label drain to a common point.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">elevations</td><td>A grid of cell elevations </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">labels</td><td>A grid to hold the watershed labels </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alter_elevations</td><td>If true, then <b>elevations</b> is altered as though <a class="el" href="priority__flood_8hpp.html#a838ba557d4977d2a062e866649cb4adb" title="Fills all pits and removes all digital dams from a DEM. ">improved_priority_flood()</a> had been applied. The result is that all cells drain to the edges of the DEM. Otherwise, <b>elevations</b> is not altered.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><ol type="1">
<li><b>elevations</b> contains the elevations of every cell or a value <em>NoData</em> for cells not part of the DEM. Note that the <em>NoData</em> value is assumed to be a negative number less than any actual data value.</li>
</ol>
</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd><ol type="1">
<li><b>elevations</b> contains no depressions or digital dams, if alter_elevations** was set.</li>
<li><b>labels</b> contains a label for each cell indicating its membership in a given watershed. Cells bearing common labels drain to common points. </li>
</ol>
</dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
